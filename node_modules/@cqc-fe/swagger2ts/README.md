# swagger2ts

åŸºäºswagger-typescript-apiï¼Œåœ¨ä¿ç•™åŸæ¥æ‰€æœ‰åŠŸèƒ½çš„æƒ…å†µä¸‹ï¼Œå†…ç½®å®šåˆ¶æ¨¡æ¿ï¼Œé€šè¿‡swaggeræ–¹æ¡ˆç”Ÿæˆapiè¯¦ç»†æ¨¡å—ã€‚ä¸swagger-typescript-apiç›¸æ¯”ï¼Œæ‹“å±•äº†ä»¥ä¸‹åŠŸèƒ½ï¼š

1. installåï¼Œåªéœ€è¦åœ¨package.jsonæ·»åŠ xxx: "gen-swagger"å‘½ä»¤å¹¶æ‰§è¡Œï¼Œå³å¯è‡ªåŠ¨ä¼šæ ¹æ®swagger.jsonåœ°å€ä½¿ç”¨å†…ç½®æ¨¡æ¿ç”Ÿæˆapiæ¨¡å—ï¼Œå¹¶ä¼šåœ¨é¡¹ç›®æ ¹ç›®å½•ç”Ÿæˆswagger.config.jsæ–‡ä»¶è¿›è¡Œæ‰€éœ€åŠŸèƒ½çš„é…ç½®ï¼Œé™ä½å›¢é˜Ÿå¼€å‘äººå‘˜ä½¿ç”¨æˆæœ¬ï¼Œç”Ÿæˆæœ€é€‚åˆé¡¹ç›®çš„apiæ¨¡å—ã€‚swagger.config.jså·²ç»å†…ç½®äº†swagger-typescript-jsçš„åŸºç¡€åŠŸèƒ½ã€‚
2. è¾“å‡ºæ–‡ä»¶ç»†è‡´åŒ–ï¼Œæ”¯æŒè‡ªå®šä¹‰ä¿®æ”¹çš„http-client.tsæ–‡ä»¶ä¾ç„¶ä¿ç•™ï¼Œè§£å†³æ¯æ¬¡ç”Ÿæˆè¿‡ç¨‹ï¼Œè¯¥æ–‡ä»¶ä¼šè¢«è¦†ç›–çš„æƒ…å†µã€‚
3. å®Œå–„axiosä»¥åŠfetchè¯·æ±‚æ–¹æ³•ï¼Œæ·»åŠ è¯·æ±‚æ‹¦æˆªå™¨ã€å“åº”æ‹¦æˆªå™¨ã€é”™è¯¯æ•è·å¤„ç†ç­‰åŠŸèƒ½ã€‚
4. è¾“å‡ºçš„apiæ–¹æ³•ç”±promiseæ”¹ä¸ºasync awaitå½¢å¼ã€‚

## Update Version Log
```
1.0.4
1ã€ä¿®æ”¹é€’å½’ç”Ÿæˆçˆ†æ ˆé—®é¢˜
```

## å®‰è£…åŠä½¿ç”¨

### step 1

```
yarn add @cqc-fe/swagger2ts
```

### step2

```
package.jsonä¸­æ·»åŠ xxx: "gen-swagger -s"
```
### step3

```
åˆæ¬¡ä½¿ç”¨ï¼Œæ‰§è¡Œ npm run xxx -p swagger.jsonåœ°å€ï¼Œåˆå§‹åŒ–swaggerã€‚
æ›´æ–°ï¼Œè¯·ç›´æ¥æ‰§è¡Œnpm run xxxå³å¯ã€‚
```

## swagger.config.js é…ç½®æ–‡ä»¶è¯´æ˜

æ”¯æŒswagger-typescript-apiæ‰€æœ‰çš„api

```
{
// å½“ä½¿ç”¨module:falseï¼Œå•æ–‡ä»¶è¾“å‡ºå½¢å¼çš„æ–‡ä»¶å‘½å
name: "MySuperbApi.ts",
// æ–‡ä»¶è¾“å‡ºè·¯å¾„
output:  './src/__generated__',	
// swagger.jsonæ–‡ä»¶åœ°å€
url: 'http://api.com/swagger.json',	
// æˆ–è€…ä¸ç”¨çº¿ä¸Šåœ°å€å½¢å¼ï¼Œæœ¬åœ°å¯¼å…¥foo/swagger.json
input: path.resolve(process.cwd(), './foo/swagger.json'),
// æè¿°
spec: {
	swagger: "2.0",
	info: {
		version: "1.0.0",
		title: "Swagger Petstore",
	},
},
// è‡ªå®šä¹‰æ¨¡æ¿è·¯å¾„ï¼Œä¼ å…¥è¯¥å±æ€§åˆ™ä¸ä¼šä½¿ç”¨å†…ç½®å®šåˆ¶æ¨¡æ¿
templates: path.resolve(process.cwd(), './api-templates'),
// ä½¿ç”¨å†…ç½®å®šåˆ¶æ¨¡æ¿ï¼Œfalseåˆ™ä¸ºä¸ä½¿ç”¨
useDefaultTemplate: true,  ï¼ˆğŸš€ï¸ æ–°å¢ï¼‰
// é€‰æ‹©ä½¿ç”¨å“ªç§è¯·æ±‚æ–¹å¼
httpClientType: "axios", // or "fetch",
defaultResponseAsSuccess: false,
// æ˜¯å¦è¾“å‡ºhttp-clientç›¸å…³æ–‡ä»¶
generateClient: true,
// æ˜¯å¦è¾“å‡ºapiçš„routeType.tsæ–‡ä»¶
generateRouteTypes: false,
// åœ¨apiæ–‡ä»¶ä¸­æ˜¯å¦ç”Ÿæˆå“åº”ä¿¡æ¯æ³¨é‡Š
generateResponses: true,
// æ˜¯å¦å°†api.tsè½¬æˆapi.jsè¾“å‡º
toJS: false,
// æ˜¯å¦å°†api.tsä¸­è¯·æ±‚å‚æ•°çš„æ•°æ®ç±»å‹æå–å‡ºæ¥
extractRequestParams: false,
// æ˜¯å¦å°†api.tsä¸­è¯·æ±‚å‚æ•°çš„requestbodyçš„æ•°æ®ç±»å‹æå–å‡ºæ¥
extractRequestBody: false,
// æ˜¯å¦å°†æšä¸¾å€¼æå–å‡ºæ¥
extractEnums: false,
//æ˜¯å¦ç›´æ¥è¿”å›å“åº”æ•°æ®çš„reponse.data
unwrapResponseData: false,
// å®šåˆ¶è¾“å‡ºæ–‡ä»¶çš„preitterè§„åˆ™
prettier: { 
printWidth: 120,
tabWidth: 2,
trailingComma: "all",
parser: "typescript",
},
// é»˜è®¤è¿”å›çš„å“åº”æ•°æ®ç±»å‹
defaultResponseType: "void",
// èƒ½å¤Ÿå°†HttpClientå®ä¾‹å‘é€åˆ°Apiæ„é€ å‡½æ•°ï¼Œé»˜è®¤ä¸ºfalse
singleHttpClient: false,
// æ˜¯å¦åœ¨æ¯æ¬¡ç”Ÿæˆæ–‡ä»¶ä¹‹å‰éƒ½æ¸…ç©ºoutputæ–‡ä»¶
cleanOutput: false,
enumNamesAsValues: false,
// æ˜¯å¦å°†apiæ¨¡å—åŒ–
moduleNameFirstTag: false,
// å°†æ‰€æœ‰â€œenumâ€ç±»å‹ç”Ÿæˆä¸ºå¹¶é›†ç±»å‹ï¼ˆT1|T2|TNï¼‰ï¼ˆé»˜è®¤å€¼ï¼šfalseï¼‰
generateUnionEnums: false,
// è‡ªå®šä¹‰æ•°æ®ç±»å‹åŠ ä¸Šå‰ç¼€
typePrefix: '',
// è‡ªå®šä¹‰æ•°æ®ç±»å‹åŠ ä¸Šåç¼€
typeSuffix: '',
// è‡ªå®šä¹‰æšä¸¾å‰ç¼€
enumKeyPrefix: '',
// è‡ªå®šä¹‰æšä¸¾åç¼€
enumKeySuffix: '',
// ç”Ÿæˆåªè¯»å±æ€§ï¼ˆé»˜è®¤å€¼ï¼šfalseï¼‰
addReadonly: false,
// æå–é€‰é¡¹
extractingOptions: {
	requestBodySuffix: ["Payload", "Body", "Input"],
	requestParamsSuffix: ["Params"],
	responseBodySuffix: ["Data", "Result", "Output"],
	responseErrorSuffix: ["Error", "Fail", "Fails", "ErrorData", "HttpError", "BadResponse"],
},
// å…è®¸è‡ªå®šä¹‰ejsæ¨¡æ¿å¹¶è¾“å‡º
extraTemplates: [],
// æ˜¯å¦å°†å®šä¹‰æ•°ç»„ç±»å‹ä» xxx[]å˜æˆArray<xxxx>
anotherArrayType: false,
fixInvalidTypeNamePrefix: "Type",
fixInvalidEnumKeyPrefix: "Value",
// å¯ä¿®æ”¹æ•°æ®ç±»å‹è½¬æ¢
codeGenConstructs: (constructs) => ({
...constructs,
RecordType: (key, value) => `MyRecord`
}),
// ç±»å‹æ˜ å°„å™¨ï¼Œå¯ä»¥è½¬æ¢æ•°æ®ç±»å‹
primitiveTypeConstructs: (constructs) => ({
	...constructs,
	string: {
	'date-time': 'Date'
	}
}),
// ç”Ÿå‘½å‘¨æœŸé’©å­ï¼Œhooks
hooks: {
	onCreateComponent: (component) => {},
	onCreateRequestParams: (rawType) => {},
	onCreateRoute: (routeData) => {},
	onCreateRouteName: (routeNameInfo, rawRouteInfo) => {},
	onFormatRouteName: (routeInfo, templateRouteName) => {},
	onFormatTypeName: (typeName, rawTypeName, schemaType) => {},
	onInit: (configuration) => {},
	onPreParseSchema: (originalSchema, typeName, schemaType) => {},
	onParseSchema: (originalSchema, parsedSchema) => {},
	onPrepareConfig: (currentConfiguration) => {},
	}
}
```






